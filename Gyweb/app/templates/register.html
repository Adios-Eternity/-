
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>bootstrap案例</title>
    <!--用百度的静态资源库的cdn安装bootstrap环境-->
    <!-- Bootstrap 核心 CSS 文件 -->
    <link href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!--font-awesome 核心我CSS 文件-->
    <link href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 在bootstrap.min.js 之前引入 -->
    <script src="../static/js/jquery.min.js"></script>
    <!-- Bootstrap 核心 JavaScript 文件 -->
    <script src="../static/js/bootstrap.min.js"></script>
    <!--jquery.validate-->
    <script type="text/javascript" src="js/jquery.validate.min.js" ></script>
    <script type="text/javascript" src="js/message.js" ></script>
    <style type="text/css">
        body{background: url(img/4.jpg) no-repeat;background-size:cover;font-size: 16px;}
        .form{background: rgba(255,255,255,0.2);width:400px;margin:100px auto;}
        #register_form{display: block;}
        .fa{display: inline-block;top: 27px;left: 6px;position: relative;color: #ccc;}
        input[type="text"],input[type="password"]{padding-left:26px;}
    </style>
</head>
<body>

<div class="container">
    <div class="form row">
        <form class="form-horizontal col-sm-offset-3 col-md-offset-3" id="register_form">
            <h3 class="form-title">register your account</h3>
            <div class="col-sm-9 col-md-9">
                <div class="form-group">
                    <i class="fa fa-user fa-lg"></i>
                    <input class="form-control required" type="text" placeholder="Username" id="r_username" name="username" autofocus="autofocus"/>
                </div>
                <div class="form-group">
                    <i class="fa fa-lock fa-lg"></i>
                    <input class="form-control required" type="password" placeholder="Password" id="r_password" name="password"/>
                </div>
                <div class="form-group">
                    <i class="fa fa-check fa-lg"></i>
                    <input class="form-control required" type="password" placeholder="Re-type Your Password" id="r_rpassword" name="rpassword"/>
                </div>
                <div class="form-group">
                    <i class="fa fa-user fa-lg"></i>
                    <input class="form-control required" type="text" placeholder="Teltphone-number" id="r_tel" name="tel"/>
                </div>
                <div class="form-group">
                    <i class="fa fa-envelope fa-lg"></i>
                    <input class="form-control eamil" type="text" placeholder="Email" name="email" id="r_email"/>
                </div>
                <div class="form-group">
                    <input type="button" class="btn btn-info pull-left" id="back_btn" value="获取" onclick="dotest()"/>
                    <input class="form-control eamil" type="text" placeholder="邮箱验证码..." id="r_code" name="code" style="width: 160px;float: right"/>

                </div>
                <div class="form-group">
                    <input type="button" class="btn btn-success pull-right" value="注册" onclick="doregister()"/>
                </div>
                <div class="form-group">
                    <h4 id="content" style="color: red"></h4>
                </div>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">
    function dotest(){
        var regsterusername = $.trim($("#r_username").val());
        var registerpassword = $.trim($("#r_password").val());
        var registerrpassword = $.trim($("#r_rpassword").val());
        var registeremail = $.trim($("#r_email").val());
        var registertel = $.trim($("#r_tel").val());
        var oUl=document.getElementById('content');

        if(registerpassword.length < 5){
            window.alert("密码长度太短！")
            return false;
        }
        else{
            var param = "username=" + regsterusername;
            param += "&password=" + registerpassword;
            param += "&rpassword=" + registerrpassword;
            param += "&tel=" + registertel;
            param += "&email=" + registeremail
            $.post('/ecode', param, function (data){
                if(data == "username-fail"){
                    oUl.innerHTML+="<h5 style='text-align: center;color: #DC143C'>用户已存在!!!</h5>";
                }
                else if(data == "password-fail"){
                    oUl.innerHTML+="<h5 style='text-align: center;color: #DC143C'>两次输入密码不相同!!!</h5>";
                }
                else if(data == "send-fail"){
                    oUl.innerHTML+="<h5 style='text-align: center;color: #DC143C'>验证码发送失败!!!</h5>";
                }
                else if(data == "send-pass"){
                    oUl.innerHTML+="<h4 style='text-align: center;color: #1E90FF'>验证码已发送!</h4>";
                }
            })
        }
    }

    function doregister() {

        var regsterusername = $.trim($("#r_username").val());
        var registerpassword = $.trim($("#r_password").val());
        var registeremail = $.trim($("#r_email").val());
        var registertel = $.trim($("#r_tel").val());
        var registercode = $.trim($("#r_code").val());
        var oUl=document.getElementById('content');

        var param = "username=" + regsterusername;
        param += "&password=" + registerpassword;
        param += "&tel=" + registertel;
        param += "&email=" + registeremail;
        param += "&code=" + registercode

        $.post('/register', param, function (data){
            if(data == "register-pass"){
                oUl.innerHTML+="<h5 style='text-align: center;color: #DC143C'>注册成功!!!</h5>";
                window.location.href="{{ url_for('web.home') }}";
            }
            else{
                oUl.innerHTML+="<h4 style='text-align: center;color: #1E90FF'>验证码错误!!!</h4>";
            }
        })

    }

</script>
</body>
</html>

